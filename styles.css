/* =====================================================
   GOINGDARK - SURVEILLANCE MODE SIMULATOR
   AUTO-DARK THEME WITH DARKER MONOCHROMATIC SHADES
   Version: 3.0.0 (No Spotlight Edition)
===================================================== */

/* === DARK THEME BASE - AUTO-APPLIED WITH ALL MODES === */
.goingdark-active {
    /* Force dark background on all elements */
    background-color: #050505 !important;
    color: #e0e0e0 !important;
    
    /* Darken all elements */
    filter: brightness(0.85) contrast(1.1) !important;
    
    /* Apply to all child elements */
    * {
        background-color: inherit !important;
        color: inherit !important;
    }
}

/* === CRITICAL FIX: Remove overflow restrictions === */
.goingdark-active body,
.goingdark-active html,
.goingdark-active {
    overflow: visible !important;
    height: auto !important;
    min-height: 100vh !important;
    position: relative !important;
}

/* === 1. GREEN ZONE - DARK GREEN MONOCHROME (FIXED) === */
.goingdark-mode-green {
    /* Simplified filter for better compatibility */
    filter: 
        brightness(0.8)
        contrast(1.4)
        grayscale(1)
        sepia(0.7) 
        hue-rotate(90deg) 
        saturate(2.5) !important;
    
    position: relative;
    background-blend-mode: multiply;
    
    /* REMOVED: overflow: auto !important; - This was causing issues */
    /* REMOVED: GPU acceleration properties that might interfere */
}

/* Dark green overlay with noise - FIXED: Use absolute instead of fixed */
.goingdark-mode-green::before {
    content: "";
    position: absolute; /* CHANGED from fixed to absolute */
    top: 0; left: 0;
    width: 100%; height: 100%;
    /* Dark green vignette */
    background: 
        radial-gradient(
            ellipse at center,
            transparent 0%,
            rgba(0, 40, 0, 0.6) 70%,
            rgba(0, 20, 0, 0.8) 100%
        ),
        /* Green noise */
        repeating-linear-gradient(
            0deg,
            rgba(0, 30, 0, 0.1),
            rgba(0, 30, 0, 0.1) 1px,
            transparent 1px,
            transparent 2px
        );
    pointer-events: none !important;
    z-index: 2147483646;
    mix-blend-mode: multiply;
    animation: green-pulse 4s ease-in-out infinite;
}

/* Green scanning lines - FIXED: Use absolute instead of fixed */
.goingdark-mode-green::after {
    content: "";
    position: absolute; /* CHANGED from fixed to absolute */
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 3px,
        rgba(0, 60, 0, 0.15) 3px,
        rgba(0, 60, 0, 0.15) 4px
    );
    pointer-events: none !important;
    z-index: 2147483645;
    mix-blend-mode: overlay;
}

@keyframes green-pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 0.8; }
}

/* === 2. STATIC FEED - DARK BLACK & WHITE === */
.goingdark-mode-bw {
    /* High contrast B&W with crushed blacks */
    filter: 
        grayscale(1) 
        contrast(2.2) 
        brightness(0.65) !important;
    
    /* Extreme contrast */
    background-blend-mode: exclusion;
}

/* Heavy TV static overlay - FIXED: Use absolute instead of fixed */
.goingdark-mode-bw::before {
    content: "";
    position: absolute; /* CHANGED from fixed to absolute */
    top: 0; left: 0;
    width: 100%; height: 100%;
    /* Heavy black & white static */
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300" opacity="0.12"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" seed="2"/><feColorMatrix type="saturate" values="0"/></filter><rect width="100%" height="100%" filter="url(%23noise)" fill="black"/></svg>');
    pointer-events: none !important;
    z-index: 2147483647;
    mix-blend-mode: overlay;
    animation: heavy-static 0.05s infinite;
}

/* Scan lines for CRT effect - FIXED: Use absolute instead of fixed */
.goingdark-mode-bw::after {
    content: "";
    position: absolute; /* CHANGED from fixed to absolute */
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.15),
        rgba(0, 0, 0, 0.15) 1px,
        transparent 1px,
        transparent 2px
    );
    pointer-events: none !important;
    z-index: 2147483646;
}

@keyframes heavy-static {
    0% { opacity: 0.4; transform: translate(0, 0); filter: contrast(1.2); }
    20% { opacity: 0.5; transform: translate(-1px, 1px); filter: contrast(1.5); }
    40% { opacity: 0.6; transform: translate(1px, -1px); filter: contrast(1.8); }
    60% { opacity: 0.5; transform: translate(-1px, -1px); filter: contrast(1.5); }
    80% { opacity: 0.4; transform: translate(1px, 1px); filter: contrast(1.2); }
    100% { opacity: 0.4; transform: translate(0, 0); filter: contrast(1.2); }
}

/* === 3. CYBER SCAN - DARK CYAN/BLUE MONOCHROME === */
.goingdark-mode-cyan {
    /* Dark cyan/blue with crushed blues */
    filter: 
        brightness(0.75)
        contrast(1.5)
        grayscale(1)
        sepia(1) 
        hue-rotate(175deg)  /* Slightly blue-leaning cyan */
        saturate(3)
        brightness(0.8) 
        contrast(1.4) !important;
    
    /* Darken non-cyan elements */
    background-blend-mode: darken;
}

/* Dark cyan data grid overlay - FIXED: Use absolute instead of fixed */
.goingdark-mode-cyan::before {
    content: "";
    position: absolute; /* CHANGED from fixed to absolute */
    top: 0; left: 0;
    width: 100%; height: 100%;
    /* Dark cyan grid */
    background: 
        linear-gradient(rgba(0, 40, 60, 0.3) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 40, 60, 0.3) 1px, transparent 1px);
    background-size: 30px 30px;
    pointer-events: none !important;
    z-index: 2147483647;
    mix-blend-mode: overlay;
    opacity: 0.4;
}

/* Pulsing dark cyan scanning line - FIXED: Use absolute instead of fixed */
.goingdark-mode-cyan::after {
    content: "";
    position: absolute; /* CHANGED from fixed to absolute */
    top: 0; left: 0;
    width: 100%; height: 3px;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(0, 80, 120, 0.9),  /* Dark cyan */
        rgba(0, 60, 100, 0.7),  /* Dark blue */
        transparent);
    box-shadow: 
        0 0 20px rgba(0, 100, 150, 0.6),
        0 0 40px rgba(0, 60, 100, 0.4);
    pointer-events: none !important;
    z-index: 2147483647;
    animation: dark-scan 3s linear infinite;
}

@keyframes dark-scan {
    0% { 
        top: 0%; 
        opacity: 0.7; 
        box-shadow: 
            0 0 15px rgba(0, 80, 120, 0.5),
            0 0 30px rgba(0, 60, 100, 0.3);
    }
    50% { 
        opacity: 1; 
        box-shadow: 
            0 0 25px rgba(0, 100, 150, 0.7),
            0 0 50px rgba(0, 80, 120, 0.5);
    }
    100% { 
        top: 100%; 
        opacity: 0.7;
        box-shadow: 
            0 0 15px rgba(0, 80, 120, 0.5),
            0 0 30px rgba(0, 60, 100, 0.3);
    }
}

/* === CRITICAL FIX: ENSURE POINTER EVENTS WORK === */
/* Force all overlay pseudo-elements to allow mouse events */
.goingdark-mode-green::before,
.goingdark-mode-green::after,
.goingdark-mode-bw::before,
.goingdark-mode-bw::after,
.goingdark-mode-cyan::before,
.goingdark-mode-cyan::after {
    pointer-events: none !important;
    -webkit-user-select: none !important;
    user-select: none !important;
}

/* Ensure scrolling works */
.goingdark-active,
.goingdark-mode-green,
.goingdark-mode-bw,
.goingdark-mode-cyan {
    pointer-events: auto !important;
}

/* === DARK THEME ENHANCEMENTS === */
/* Force dark backgrounds on specific elements */
.goingdark-active img,
.goingdark-active video,
.goingdark-active iframe {
    filter: brightness(0.7) contrast(1.2) !important;
}

/* Darken text for better readability */
.goingdark-active p,
.goingdark-active h1,
.goingdark-active h2,
.goingdark-active h3,
.goingdark-active h4,
.goingdark-active h5,
.goingdark-active h6,
.goingdark-active span,
.goingdark-active div,
.goingdark-active a {
    color: #cccccc !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
}

/* Darken background elements */
.goingdark-active {
    /* Darken all backgrounds */
    background-image: none !important;
    
    /* Remove light backgrounds */
    * {
        background-image: none !important;
    }
}

/* Fix for light-colored inputs/buttons */
.goingdark-active input,
.goingdark-active textarea,
.goingdark-active button,
.goingdark-active select {
    background-color: #222 !important;
    color: #ddd !important;
    border-color: #444 !important;
}

/* === TRANSITION EFFECTS === */
html {
    transition: 
        filter 0.6s ease,
        background-color 0.6s ease,
        color 0.6s ease !important;
}

/* Smooth mode switching */
.goingdark-active {
    transition: 
        filter 0.8s cubic-bezier(0.4, 0, 0.2, 1),
        background-color 0.8s ease,
        color 0.8s ease !important;
}

/* === UTILITY CLASSES === */
/* Ensure dark theme applies everywhere */
body.goingdark-active,
html.goingdark-active {
    background: #050505 !important;
    color: #ccc !important;
}

/* Force dark scrollbars */
.goingdark-active::-webkit-scrollbar-track {
    background: #111 !important;
}

.goingdark-active::-webkit-scrollbar-thumb {
    background: #333 !important;
}

.goingdark-active::-webkit-scrollbar-thumb:hover {
    background: #444 !important;
}

/* Fix for elements that might resist filters */
.goingdark-active img, 
.goingdark-active video, 
.goingdark-active canvas, 
.goingdark-active svg {
    filter: inherit !important;
}

/* === PRINT MEDIA SUPPRESSION === */
@media print {
    .goingdark-active,
    .goingdark-mode-green,
    .goingdark-mode-bw,
    .goingdark-mode-cyan {
        display: none !important;
        visibility: hidden !important;
    }
}
